dbGetQuery
library(RGDALDB)
dbGetQuery(db, "SELECT * FROM nc WHERE AREA < 0.07")
db <- dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
dbGetQuery(db, "SELECT * FROM nc WHERE AREA < 0.07")
dbSendQuery(db, "SELECT * FROM nc WHERE AREA < 0.07")
dbSendQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
dbGetQuery
library(DBI)
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
devtools::load_all(".")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
class(res)
Q
library(RGDALDB)
library(RGDALDB)
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
str(rs)
str(res)
library(RGDALDB)
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
devtools::load_all(".")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
dbReadTable
dbReadTable(db, "nc.gpkg")
?dbReadTable
dbReadTable(db, 'nc.gpkg')
dbListTables()
dbListTables
RSQLite::dbListTables
RPostgres::tab
class(db)
sf::st_layers(db@dsn)
str(sf::st_layers(db@dsn))
db
devtools::load_all(".")
db
dbListTables(db)
dbExistsTable
library(RGDALDB)
dbExistsTable(db, "nc.gpkg")
dbExistsTable(db, "layer")
dbListFields
class(db)
devtools::load_all(".")
dbListFields(db, "nc.gpkg")
devtools::load_all(".")
f
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB")
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
con
tbl(con, "nc.gpkg")
library(dplyr)
library(DBI)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg")
sf::st_as_sf(tbl(con, "nc.gpkg"))
dbGetInfo(db)
dbGetInfo
library(RGDALDB)
db
dbGetInfo(db)
db_desc(db)
?collapse
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg") %>% collapse()
tbl(con, "nc.gpkg") %>% collect()
tbl(con, "nc.gpkg") %>% compute()
tbl(con, "nc.gpkg") %>% compute("nc.gpkg")
tbl(con, "nc.gpkg") %>% filter()
tbl(con, "nc.gpkg") %>% filter(AREA == 0.124)
tbl(con, "nc.gpkg") %>% filter(AREA == 0.124) %>% collect()
tbl(con, "nc.gpkg") %>% filter(AREA == 0.124) %>% collect()
tbl(con, "nc.gpkg") %>% filter(AREA == 0.124)
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.5, 1))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 1))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% collect()
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% compute()
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% summarize()
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% summarize(min(AREA))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% mutate(AREA = AREA * 2)
tbl(con, "nc.gpkg") %>% left_join(con, "nc.gpkg")
tbl(con, "nc.gpkg") %>% left_join(tbl(con, "nc.gpkg"))
tbl(con, "nc.gpkg") %>% left_join(tbl(con, "nc.gpkg"), CRESS_ID)
tbl(con, "nc.gpkg") %>% left_join(tbl(con, "nc.gpkg"), "CRESS_ID")
## this works, no sense until we have
tbl(con, "nc.gpkg") %>% left_join(tbl(con, "nc.gpkg"), "CRESS_ID")
tbl(con, "nc.gpkg") %>% transmute(geom, ID)
tbl(con, "nc.gpkg") %>% transmute(geom, ID = row_number())
tbl(con, "nc.gpkg") %>% transmute(geom, ID = FID)
tbl(con, "nc.gpkg") %>% transmute(geom, FID = FID)
tbl(con, "nc.gpkg") %>% select(geom, FID = FID)
tbl(con, "nc.gpkg") %>% select(geom, FID)
tbl(con, "nc.gpkg") %>% select(geom, AREA)
tbl(con, "nc.gpkg") %>% select(geom, AREA)  %>% mutate(ID = FID)
usethis::use_readme_rmd()
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg") %>% mutate(n = row_number())
tbl(con, "nc.gpkg") %>% mutate(n = FID)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% mutate(AREA = AREA * 2)
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% mutate(AREA = AREA * 2)
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% mutate(AREA = AREA * 2)
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% mutate(NN = AREA * 2)
?filter.sf
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf")
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
nclazy <- tibl(con, "nc.gpkg")
nclazy <- tbl(con, "nc.gpkg")
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
nclazy <- tbl(con, "nc")
nc %>% filter(AREA > .1) %>% plot()
nclazy %>% filter(AREA > .1) %>% plot()
library(sf)
nclazy %>% filter(AREA > .1) %>% plot()
nclazy %>% filter(AREA > .1)
nclazy %>% filter(AREA > .1) %>% collect() %>%  plot()
nclazy %>%
dplyr::filter(AREA > .1) %>%
dplyr::select(AREA, PERIMETER, BIR74, FIPS) %>%
collect() %>%
plot()
sf::sf_extSoftVersion()
## NONSENSE for now
gdal <- sf::sf_extSoftVersion()["GDAL"]
## NONSENSE for now
gdal <- paste0("GDAL", sf::sf_extSoftVersion()["GDAL"])
gdal
devtools::load_all(".")
nclazy %>% filter(AREA > .1)
nclazy
library(RGDALDB)
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
nclazy <- tbl(con, "nc")
nclazy
devtools::load_all(".")
nclazy
devtools::load_all(".")
devtools::load_all(".")
nclazy
devtools::load_all(".")
nclazy
devtools::load_all(".")
devtools::load_all(".")
nclazy
library(RGDALDB)
devtools::load_all(".")
nc
f
db@dsn
con@dns
con@dsn
st_layers(con@dsn)
sf::st_layers(con@dsn)
str(sf::st_layers(con@dsn))
sf::st_layers(con@dsn)$driver[1]
devtools::load_all(".")
nclazy
devtools::load_all(".")
nclazy
devtools::load_all(".")
nclazy
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
nclazy <- tbl(con, "nc")
nclazyr
nclazy
layers
layers$driver
devtools::load_all(".")
nclazyr
nclazy
library(RGDALDB)
library(RGDALDB)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "man/figures/README-",
out.width = "100%"
)
library(dplyr)
library(DBI)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 1))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 1))
system.time(tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 1)))
rbenchmark::benchmark(lazy = tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 1)),
sf = sf::st_read(con@dsn))
rbenchmark::benchmark(lazy = tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 1)),
sf = sf::read_sf(con@dsn))
raadfiles::thelist_files(format = "shp", pattern = "transport_segments_hobart")
f <- raadfiles::thelist_files(format = "shp", pattern = "transport_segments_hobart")$fullname[1]
con <- dbConnect(RGDALDB::GDALDB(), f)
con
tbl(con, "list_transport_segments_hobart")
rbenchmark::benchmark(lazy = tbl(con, "list_transport_segments_hobart")),
sf = sf::read_sf(con@dsn))
rbenchmark::benchmark(lazy = tbl(con, "list_transport_segments_hobart"),
sf = sf::read_sf(con@dsn),
replications = 2)
rbenchmark::benchmark(lazy = tbl(con, "list_transport_segments_hobart"),
sf = sf::read_sf(con@dsn),
replications = 20)
tbl(con, "list_transport_segments_hobart")
x <- tbl(con, "list_transport_segments_hobart") %>% collect(n = 10)
plot(x)
x <- tbl(con, "list_transport_segments_hobart") %>% collect(n = 10000)
plot(x[1])
tbl(con, "list_transport_segments_hobart") %>% tally(n = 10000)
tbl(con, "list_transport_segments_hobart") %>% tally()
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
tbl(con, "nc.gpkg") %>% filter(between(AREA, 0.05, 0.1)) %>% summarize(min(AREA))
devtools::load_all(".")
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg")
abbreviate("/perm_storage/home/mdsumner/R/x86_64-pc-linux-gnu-library/3.5/RGDALDB/extdata/nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
devtools::load_all(".")
devtools::load_all(".")
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
"GPKG:/perm_storage/home/mdsumner/R/x86_64-pc-linux-gnu-library/3.5/RGDALDB/extdata/nc.gpkg:nc.gpkg"
read_sf("GPKG:/perm_storage/home/mdsumner/R/x86_64-pc-linux-gnu-library/3.5/RGDALDB/extdata/nc.gpkg:nc.gpkg")
library(sf)
read_sf("GPKG:/perm_storage/home/mdsumner/R/x86_64-pc-linux-gnu-library/3.5/RGDALDB/extdata/nc.gpkg:nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
st_layers("/perm_storage/home/mdsumner/R/x86_64-pc-linux-gnu-library/3.5/RGDALDB/extdata/nc.gpkg")
devtools::load_all(".")
devtools::load_all(".")
tbl(con, "nc.gpkg")
x
str(x)
devtools::load_all(".")
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
dbGetInfo(con)
devtools::load_all(".")
dbGetInfo(con)
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
st_sf(geometry = st_point(cbind(1, 1)))
st_sf(geometry = st_sfc(st_point(cbind(1, 1))))
class(st_sf(geometry = st_sfc(st_point(cbind(1, 1)))))
?setClass
devtools::load_all(".")
tbl(con, "nc.gpkg")
?setOldClass
devtools::load_all(".")
devtools::load_all(".")
source('~/Git/RGDALDB/R/GDALDB.R', echo=TRUE)
devtools::load_all(".")
library(dplyr)
library(DBI)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
tbl(con, "nc.gpkg")
devtools::load_all(".")
tbl(con, "nc.gpkg")
?setClass
devtools::load_all(".")
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg")
tbl(con, "nc.gpkg") %>% tally()
tibble::tibble(geometry = st_sfc(st_point(cbind(1, 1)))
)
tibble::tibble(geometry = st_sfc(st_point(cbind(1, 1))))
library(sf)
tibble::tibble(geometry = st_sfc(st_point(cbind(1, 1))))
sf::st_as_sf(tibble::tibble(geometry = st_sfc(st_point(cbind(1, 1)))))
class(sf::st_as_sf(tibble::tibble(geometry = st_sfc(st_point(cbind(1, 1))))))
str(sf::st_as_sf(tibble::tibble(geometry = st_sfc(st_point(cbind(1, 1))))))
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
library(dplyr)
library(DBI)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
tbl(con, "nc.gpkg")
library(sf)
tbl(con, "nc.gpkg")
findClass("sf")
findClass("sf", formal = F)
})
findClass("sf", formal = F)
isClass("sf", formal = F)
isClass("sf", formal = T)
devtools::load_all(".")
tbl(con, "nc.gpkg")
system.file(package = "maptools")
system.file("extdata", package = "maptools")
system.file("shp", package = "maptools")
list.files(system.file(package = "maptools"))
system.file("shapes", package = "maptools")
list.files(system.file("shapes", package = "maptools"))
?columbus
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shapes/baltim.shp", package = "maptools"))
(nclazy <- tbl(con, "nc"))
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shapes/baltim.shp", package = "maptools"))
(nclazy <- tbl(con, "nc"))
con@dsn
(nclazy <- tbl(con, "baltim"))
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shapes/columbus.shp", package = "maptools"))
(nclazy <- tbl(con, "columbus"))
sf::read_sf(con@dsn)
library(RGDALDB)
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shapes/columbus.shp", package = "maptools"))
(nclazy <- tbl(con, "columbus"))
library(RGDALDB)
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shapes/columbus.shp", package = "maptools"))
(nclazy <- tbl(con, "columbus"))
devtools::load_all(".")
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shapes/columbus.shp", package = "maptools"))
(nclazy <- tbl(con, "columbus"))
statement
as.character(statement)
conn@dsn
vapour::vapour_read_attributes(conn@dsn, sql = statement)
sf::read_sf(conn@dsn, query = statement)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
sf::read_sf(conn@dsn, query = statement)
sf::st_read(conn@dsn, query = statement)
devtools::load_all(".")
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
devtools::load_all(".")
(nclazy <- tbl(con, "nc"))
str(geom)
statement
str(att)
c(att, geom)
as_tibble(c(att, geom))
out <- tibble::as_tibble(c(att, geom))
out
new("GDALDBResult", data = out)
devtools::load_all(".")
devtools::load_all(".")
(nclazy <- tbl(con, "nc"))
traceback()
devtools::load_all(".")
(nclazy <- tbl(con, "nc"))
con
devtools::load_all(".")
con
nclazy <- tbl(con, "nc")
class(nclazy)
str(nclazy)
con
nclazy %>%
dplyr::filter(AREA > .1)
nclazy %>%
dplyr::filter(AREA > .1) %>%
dplyr::select(AREA, PERIMETER, BIR74, FIPS) %>%
collect()
a <- nclazy %>%
dplyr::filter(AREA > .1) %>%
dplyr::select(AREA, PERIMETER, BIR74, FIPS) %>%
collect()
traceback()
devtools::load_all(".")
nclazy
print(nclazy)
traceback()
devtools::load_all(".")
nclazy
nclazy %>% filter()
devtools::load_all(".")
nclazy %>% filter()
nclazy %>% filter(FID < 10)
nclazy %>% filter(AREA < 10)
devtools::load_all(".")
nclazy %>% filter(AREA < 10)
x <- nclazy %>% filter(AREA < 10)
x <- nclazy %>% filter(AREA < 10) %>% collect()
library(RGDALDB)
devtools::install_github("barryrowlingson/sf@execute_sql")
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
tibble::tibble()
str(tibble::tibble())
devtools::load_all(".")
(nclazy <- tbl(con, "nc"))
devtools::load_all(".")
(nclazy <- tbl(con, "nc"))
library(RGDALDB)
(nclazy <- tbl(con, "nc"))
example(st_read)
library(sf)
example(st_read)
as_tibble(nc)
class(as_tibble(nc))
library(RGDALDB)
library(dplyr)
library(DBI)
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
db <- dbConnect(RGDALDB::GDALDB(), dsn = system.file("extdata/nc.gpkg", package= "RGDALDB"))
#dbWriteTable(db, "mtcars", mtcars)
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
devtools::load_all(".")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
devtools::load_all(".")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
devtools::load_all(".")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
sf:::as.data.frame.s
sf:::as.data.frame.sf
devtools::load_all(".")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07") %>% collect()
str(dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07") %>% collect())
devtools::load_all(".")
str(dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07") %>% collect())
dbGetQuery(db, "SELECT * FROM 'nc.gpkg' WHERE AREA < 0.07")
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
library(sf)
nclazy %>%
dplyr::filter(AREA > .1) %>%
dplyr::select(AREA, PERIMETER, BIR74, FIPS) %>%
collect() %>%
plot()
nclazy %>%
dplyr::filter(AREA > .1) %>%
dplyr::select(AREA, PERIMETER, BIR74, FIPS) %>%
collect() %>%
sf::st_as_sf() %>%
plot()
devtools::load_all(".")
nclazy
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
library(RGDALDB)
(nclazy <- tbl(con, "nc"))
class(out)
out
str(geom)
geom
vapour::vapour_read_geometry_text(conn@dsn, sql = statement, textformat = "json")
vapour::vapour_read_attributes(conn@dsn, sql = statement)
# out <- tibble::as_tibble(out)
geom <- tibble::as_tibble(geometry = unlist(vapour::vapour_read_geometry_text(conn@dsn, sql = statement, textformat = "json")))
geom
tibble(geometry = list())
tibble(geometry = character())
unlist(vapour::vapour_read_geometry_text(conn@dsn, sql = statement, textformat = "json"))
as.character(vapour::vapour_read_geometry_text(conn@dsn, sql = statement, textformat = "json"))
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
library(RGDALDB)
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
dplyr::vars(nclazy)
devtools::load_all(".")
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc"))
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc") %>% collect())
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc") %>% collect(n = 4))
geojsonsf::geojson_sf()
con <- DBI::dbConnect(RGDALDB::GDALDB(), dsn = system.file("shape/nc.shp", package="sf"))
(nclazy <- tbl(con, "nc") %>% collect(n = 4))
nclazy
geojsonsf::geojson_sf(nclazy$geometry)
geojsonsf::geojson_sf(character())
geojsonsf::geojson_sf(character(0))
vapour::vapour_layer_names(db@dsn)
